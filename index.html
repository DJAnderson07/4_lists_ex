<!DOCTYPE html>
<html>
<head>
  <title>Lists and an Applied Example</title>
  <meta charset="utf-8">
  <meta name="description" content="Lists and an Applied Example">
  <meta name="author" content="Daniel Anderson">
  <meta name="generator" content="slidify" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/default.css" media="all" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/phone.css" 
    media="only screen and (max-device-width: 480px)" >
  <link rel="stylesheet" href="libraries/frameworks/io2012/css/slidify.css" >
  <link rel="stylesheet" href="libraries/highlighters/highlight.js/css/zenburn.css" />
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->  
  
  <!-- Grab CDN jQuery, fall back to local if offline -->
  <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.min.js"></script>
  <script>window.jQuery || document.write('<script src="libraries/widgets/quiz/js/jquery.js"><\/script>')</script> 
  <script data-main="libraries/frameworks/io2012/js/slides" 
    src="libraries/frameworks/io2012/js/require-1.0.8.min.js">
  </script>
  
  

</head>
<body style="opacity: 0">
  <slides class="layout-widescreen">
    
    <!-- LOGO SLIDE -->
        <slide class="title-slide segue nobackground">
  <hgroup class="auto-fadein">
    <h1>Lists and an Applied Example</h1>
    <h2>Lecture 4: Taste of R Workshop, UO COE</h2>
    <p>Daniel Anderson<br/></p>
  </hgroup>
  <article></article>  
</slide>
    

    <!-- SLIDES -->
    <slide class="" id="slide-1" style="background:;">
  <article data-timings="">
    <style>
em {
  font-style: italic
}
</style>

<style>
strong {
  font-weight: bold;
}
</style>

<h2>Agenda</h2>

<ul>
<li>Presentation by Dave Degarmo (~10 minutes)</li>
<li>Introduction to Lists</li>
<li>Introduction to the <em>purrr</em> package for working with lists</li>
<li>Artificial example</li>
<li>Full applied example</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-2" style="background:;">
  <hgroup>
    <h1>lists</h1>
  </hgroup>
  <article data-timings="">
    
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-3" style="background:;">
  <hgroup>
    <h2>Lists versus other data structures</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>To date, we have mostly worked with data frames

<ul>
<li>type of list</li>
</ul></li>
<li>Each column of a data frame is (almost always) an atomic vector of a specific type

<ul>
<li>double</li>
<li>integer</li>
<li>character</li>
<li>logical</li>
</ul></li>
<li>All elements within an atomic vector must be of the same type (implicit coercion). </li>
<li>Lists are vectors (not atomic) where every element can be of a different type, including other lists.</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-4" style="background:;">
  <hgroup>
    <h2>Contrasting lists and atomic vectors</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <h1>Lists</h1>

<pre><code class="r">list(&quot;a&quot;, 4.35, TRUE, 7L)
</code></pre>

<pre><code>## [[1]]
## [1] &quot;a&quot;
## 
## [[2]]
## [1] 4.35
## 
## [[3]]
## [1] TRUE
## 
## [[4]]
## [1] 7
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <h1>Vectors</h1>

<p>(implicit coercion)</p>

<pre><code class="r">c(&quot;a&quot;, 4.35, TRUE, 7L)
</code></pre>

<pre><code>## [1] &quot;a&quot;    &quot;4.35&quot; &quot;TRUE&quot; &quot;7&quot;
</code></pre>

<pre><code class="r">c(4.35, TRUE, 7L)
</code></pre>

<pre><code>## [1] 4.35 1.00 7.00
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-5" style="background:;">
  <hgroup>
    <h2>Quick aside</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Logical vectors can be coerced to binary numeric (0/1) and vice versa.</li>
<li>This feature can make a really handy way to investigate missing data.</li>
</ul>

<pre><code class="r">some_data &lt;- c(12, 15, NA, 5, 7, NA, NA, 18, 6, NA)
sum(is.na(some_data))
</code></pre>

<pre><code>## [1] 4
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-6" style="background:;">
  <hgroup>
    <h2>Lists</h2>
  </hgroup>
  <article data-timings="">
    <p>Note that the length of list elements can all be different.</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">l &lt;- list(
    c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;),
    1:5,
    rep(c(T,F), 7),
    rnorm(3, 100, 25)
          )
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">l
</code></pre>

<pre><code>## [[1]]
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;
## 
## [[2]]
## [1] 1 2 3 4 5
## 
## [[3]]
##  [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE
## [12] FALSE  TRUE FALSE
## 
## [[4]]
## [1]  55.33627  94.98044 100.45670
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-7" style="background:;">
  <hgroup>
    <h2>Lists returned by functions</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Many functions return a list of objects. This is because lists are a great way to store a lot of varied information. For example: <code>lm</code>.</li>
</ul>

<pre><code class="r">mod &lt;- lm(hp ~ mpg, data = mtcars)
str(mod)
</code></pre>

<pre><code>## List of 12
##  $ coefficients : Named num [1:2] 324.08 -8.83
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;mpg&quot;
##  $ residuals    : Named num [1:32] -28.7 -28.7 -29.8 -25.1 16 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##  $ effects      : Named num [1:32] -829.8 296.3 -23.6 -20 19.3 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;(Intercept)&quot; &quot;mpg&quot; &quot;&quot; &quot;&quot; ...
##  $ rank         : int 2
##  $ fitted.values: Named num [1:32] 139 139 123 135 159 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##  $ assign       : int [1:2] 0 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:32, 1:2] -5.657 0.177 0.177 0.177 0.177 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:32] &quot;Mazda RX4&quot; &quot;Mazda RX4 Wag&quot; &quot;Datsun 710&quot; &quot;Hornet 4 Drive&quot; ...
##   .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;mpg&quot;
##   .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
##   ..$ qraux: num [1:2] 1.18 1.02
##   ..$ pivot: int [1:2] 1 2
##   ..$ tol  : num 1e-07
##   ..$ rank : int 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
##  $ df.residual  : int 30
##  $ xlevels      : Named list()
##  $ call         : language lm(formula = hp ~ mpg, data = mtcars)
##  $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language hp ~ mpg
##   .. ..- attr(*, &quot;variables&quot;)= language list(hp, mpg)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:2] &quot;hp&quot; &quot;mpg&quot;
##   .. .. .. ..$ : chr &quot;mpg&quot;
##   .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;mpg&quot;
##   .. ..- attr(*, &quot;order&quot;)= int 1
##   .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(hp, mpg)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;hp&quot; &quot;mpg&quot;
##  $ model        :&#39;data.frame&#39;:   32 obs. of  2 variables:
##   ..$ hp : num [1:32] 110 110 93 110 175 105 245 62 95 123 ...
##   ..$ mpg: num [1:32] 21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...
##   ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language hp ~ mpg
##   .. .. ..- attr(*, &quot;variables&quot;)= language list(hp, mpg)
##   .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. ..$ : chr [1:2] &quot;hp&quot; &quot;mpg&quot;
##   .. .. .. .. ..$ : chr &quot;mpg&quot;
##   .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;mpg&quot;
##   .. .. ..- attr(*, &quot;order&quot;)= int 1
##   .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, &quot;predvars&quot;)= language list(hp, mpg)
##   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;hp&quot; &quot;mpg&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;lm&quot;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-8" style="background:;">
  <article data-timings="">
    <p>You can access the elements through the list</p>

<pre><code class="r">mod$coefficients
</code></pre>

<pre><code>## (Intercept)         mpg 
##  324.082314   -8.829731
</code></pre>

<pre><code class="r">mod$residuals
</code></pre>

<pre><code>##           Mazda RX4       Mazda RX4 Wag          Datsun 710 
##         -28.6579634         -28.6579634         -29.7644476 
##      Hornet 4 Drive   Hornet Sportabout             Valiant 
##         -25.1260710          16.0336553         -59.2641833 
##          Duster 360           Merc 240D            Merc 230 
##          47.1828390         -46.6368780         -27.7644476 
##            Merc 280           Merc 280C          Merc 450SE 
##         -31.5514792         -43.9131026           0.7252741 
##          Merc 450SL         Merc 450SLC  Cadillac Fleetwood 
##           8.6720320          -9.8704031         -27.2531119 
## Lincoln Continental   Chrysler Imperial            Fiat 128 
##         -17.2531119          35.7147314          28.0009699 
##         Honda Civic      Toyota Corolla       Toyota Corona 
##          -3.6584921          40.2455664         -37.2430979 
##    Dodge Challenger         AMC Javelin          Camaro Z28 
##         -37.2214838         -39.8704031          38.3531080 
##    Pontiac Firebird           Fiat X1-9       Porsche 914-2 
##          20.4485208         -17.0306581          -3.5093084 
##        Lotus Europa      Ford Pantera L        Ferrari Dino 
##          57.3415079          79.4274355          24.8633863 
##       Maserati Bora          Volvo 142E 
##         143.3636507         -26.1260710
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-9" style="background:;">
  <hgroup>
    <h2>Extractors</h2>
  </hgroup>
  <article data-timings="">
    <p>Often with functions there are more efficient methods for extracting model output.</p>

<pre><code class="r">coef(mod)
</code></pre>

<pre><code>## (Intercept)         mpg 
##  324.082314   -8.829731
</code></pre>

<p>In this case the methods are roughly equivalent, but sometimes it can make a
  difference (<em>ltm</em> example)</p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-10" style="background:;">
  <hgroup>
    <h2>Other functions will transform data into lists</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">cyls &lt;- split(mtcars, mtcars$cyl)
str(cyls)
</code></pre>

<pre><code>## List of 3
##  $ 4:&#39;data.frame&#39;:   11 obs. of  11 variables:
##   ..$ mpg : num [1:11] 22.8 24.4 22.8 32.4 30.4 33.9 21.5 27.3 26 30.4 ...
##   ..$ cyl : num [1:11] 4 4 4 4 4 4 4 4 4 4 ...
##   ..$ disp: num [1:11] 108 146.7 140.8 78.7 75.7 ...
##   ..$ hp  : num [1:11] 93 62 95 66 52 65 97 66 91 113 ...
##   ..$ drat: num [1:11] 3.85 3.69 3.92 4.08 4.93 4.22 3.7 4.08 4.43 3.77 ...
##   ..$ wt  : num [1:11] 2.32 3.19 3.15 2.2 1.61 ...
##   ..$ qsec: num [1:11] 18.6 20 22.9 19.5 18.5 ...
##   ..$ vs  : num [1:11] 1 1 1 1 1 1 1 1 0 1 ...
##   ..$ am  : num [1:11] 1 0 0 1 1 1 0 1 1 1 ...
##   ..$ gear: num [1:11] 4 4 4 4 4 4 3 4 5 5 ...
##   ..$ carb: num [1:11] 1 2 2 1 2 1 1 1 2 2 ...
##  $ 6:&#39;data.frame&#39;:   7 obs. of  11 variables:
##   ..$ mpg : num [1:7] 21 21 21.4 18.1 19.2 17.8 19.7
##   ..$ cyl : num [1:7] 6 6 6 6 6 6 6
##   ..$ disp: num [1:7] 160 160 258 225 168 ...
##   ..$ hp  : num [1:7] 110 110 110 105 123 123 175
##   ..$ drat: num [1:7] 3.9 3.9 3.08 2.76 3.92 3.92 3.62
##   ..$ wt  : num [1:7] 2.62 2.88 3.21 3.46 3.44 ...
##   ..$ qsec: num [1:7] 16.5 17 19.4 20.2 18.3 ...
##   ..$ vs  : num [1:7] 0 0 1 1 1 1 0
##   ..$ am  : num [1:7] 1 1 0 0 0 0 1
##   ..$ gear: num [1:7] 4 4 3 3 4 4 5
##   ..$ carb: num [1:7] 4 4 1 1 4 4 6
##  $ 8:&#39;data.frame&#39;:   14 obs. of  11 variables:
##   ..$ mpg : num [1:14] 18.7 14.3 16.4 17.3 15.2 10.4 10.4 14.7 15.5 15.2 ...
##   ..$ cyl : num [1:14] 8 8 8 8 8 8 8 8 8 8 ...
##   ..$ disp: num [1:14] 360 360 276 276 276 ...
##   ..$ hp  : num [1:14] 175 245 180 180 180 205 215 230 150 150 ...
##   ..$ drat: num [1:14] 3.15 3.21 3.07 3.07 3.07 2.93 3 3.23 2.76 3.15 ...
##   ..$ wt  : num [1:14] 3.44 3.57 4.07 3.73 3.78 ...
##   ..$ qsec: num [1:14] 17 15.8 17.4 17.6 18 ...
##   ..$ vs  : num [1:14] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ am  : num [1:14] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ gear: num [1:14] 3 3 3 3 3 3 3 3 3 3 ...
##   ..$ carb: num [1:14] 2 4 3 3 3 4 4 4 2 2 ...
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-11" style="background:;">
  <hgroup>
    <h2>More on lists</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>Note that the previous slide looked like a nested list (list inside a list). 
This is because data frames are lists, where each element of the list is a
vector of the same length.</li>
<li>lists are tremendously useful and flexible, and can lead to massive jumps in efficiency when combined with loops

<ul>
<li>Often want to loop through a list and apply a function to each element
of the list.</li>
</ul></li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-12" style="background:;">
  <hgroup>
    <h2>Lists and data frames</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <pre><code class="r">l &lt;- list(
    lets = letters[1:5],
    ints = 9:5,
    dbl = rnorm(5, 12, 0.75)
    )
l
</code></pre>

<pre><code>## $lets
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot;
## 
## $ints
## [1] 9 8 7 6 5
## 
## $dbl
## [1] 11.04065 12.25495 12.46319 11.35958 12.34298
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">as.data.frame(l)
</code></pre>

<pre><code>##   lets ints      dbl
## 1    a    9 11.04065
## 2    b    8 12.25495
## 3    c    7 12.46319
## 4    d    6 11.35958
## 5    e    5 12.34298
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-13" style="background:;">
  <hgroup>
    <h1>Alternative</h1>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <pre><code class="r">dframe &lt;- data.frame(
    lets = letters[1:5],
    ints = 9:5,
    dbl = rnorm(5, 12, 0.75)
    )
dframe
</code></pre>

<pre><code>##   lets ints      dbl
## 1    a    9 13.07447
## 2    b    8 11.56394
## 3    c    7 12.10932
## 4    d    6 11.97803
## 5    e    5 12.88137
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">as.list(dframe)
</code></pre>

<pre><code>## $lets
## [1] a b c d e
## Levels: a b c d e
## 
## $ints
## [1] 9 8 7 6 5
## 
## $dbl
## [1] 13.07447 11.56394 12.10932 11.97803 12.88137
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="segue" id="slide-14" style="background:;">
  <hgroup>
    <h1>Brief introduction to <em>purrr</em></h1>
  </hgroup>
  <article data-timings="">
    <p><img src="assets/img/purrr.png" alt="purr"></p>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-15" style="background:;">
  <hgroup>
    <h2><em>purrr</em></h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>As everything with the tidyverse, base equivalents exist</li>
<li><em>purrr</em> (note three r&#39;s) is pipe (<code>%&gt;%</code>) friendly</li>
<li>Has nice parallelization features. </li>
<li>We&#39;ll focus today on <code>map</code> and friends, which is the primary function from the package.</li>
<li>Generally used with lists (for me at least), but can work with any type of vector.</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-16" style="background:;">
  <hgroup>
    <h2>Data</h2>
  </hgroup>
  <article data-timings="">
    <p><em>mtcars</em> dataset split by cylinder</p>

<pre><code class="r">cyls &lt;- split(mtcars, mtcars$cyl)
str(cyls)
</code></pre>

<pre><code>## List of 3
##  $ 4:&#39;data.frame&#39;:   11 obs. of  11 variables:
##   ..$ mpg : num [1:11] 22.8 24.4 22.8 32.4 30.4 33.9 21.5 27.3 26 30.4 ...
##   ..$ cyl : num [1:11] 4 4 4 4 4 4 4 4 4 4 ...
##   ..$ disp: num [1:11] 108 146.7 140.8 78.7 75.7 ...
##   ..$ hp  : num [1:11] 93 62 95 66 52 65 97 66 91 113 ...
##   ..$ drat: num [1:11] 3.85 3.69 3.92 4.08 4.93 4.22 3.7 4.08 4.43 3.77 ...
##   ..$ wt  : num [1:11] 2.32 3.19 3.15 2.2 1.61 ...
##   ..$ qsec: num [1:11] 18.6 20 22.9 19.5 18.5 ...
##   ..$ vs  : num [1:11] 1 1 1 1 1 1 1 1 0 1 ...
##   ..$ am  : num [1:11] 1 0 0 1 1 1 0 1 1 1 ...
##   ..$ gear: num [1:11] 4 4 4 4 4 4 3 4 5 5 ...
##   ..$ carb: num [1:11] 1 2 2 1 2 1 1 1 2 2 ...
##  $ 6:&#39;data.frame&#39;:   7 obs. of  11 variables:
##   ..$ mpg : num [1:7] 21 21 21.4 18.1 19.2 17.8 19.7
##   ..$ cyl : num [1:7] 6 6 6 6 6 6 6
##   ..$ disp: num [1:7] 160 160 258 225 168 ...
##   ..$ hp  : num [1:7] 110 110 110 105 123 123 175
##   ..$ drat: num [1:7] 3.9 3.9 3.08 2.76 3.92 3.92 3.62
##   ..$ wt  : num [1:7] 2.62 2.88 3.21 3.46 3.44 ...
##   ..$ qsec: num [1:7] 16.5 17 19.4 20.2 18.3 ...
##   ..$ vs  : num [1:7] 0 0 1 1 1 1 0
##   ..$ am  : num [1:7] 1 1 0 0 0 0 1
##   ..$ gear: num [1:7] 4 4 3 3 4 4 5
##   ..$ carb: num [1:7] 4 4 1 1 4 4 6
##  $ 8:&#39;data.frame&#39;:   14 obs. of  11 variables:
##   ..$ mpg : num [1:14] 18.7 14.3 16.4 17.3 15.2 10.4 10.4 14.7 15.5 15.2 ...
##   ..$ cyl : num [1:14] 8 8 8 8 8 8 8 8 8 8 ...
##   ..$ disp: num [1:14] 360 360 276 276 276 ...
##   ..$ hp  : num [1:14] 175 245 180 180 180 205 215 230 150 150 ...
##   ..$ drat: num [1:14] 3.15 3.21 3.07 3.07 3.07 2.93 3 3.23 2.76 3.15 ...
##   ..$ wt  : num [1:14] 3.44 3.57 4.07 3.73 3.78 ...
##   ..$ qsec: num [1:14] 17 15.8 17.4 17.6 18 ...
##   ..$ vs  : num [1:14] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ am  : num [1:14] 0 0 0 0 0 0 0 0 0 0 ...
##   ..$ gear: num [1:14] 3 3 3 3 3 3 3 3 3 3 ...
##   ..$ carb: num [1:14] 2 4 3 3 3 4 4 4 2 2 ...
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-17" style="background:;">
  <hgroup>
    <h2><code>map</code> basic usage</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(purrr)
map(cyls, ~lm(hp ~ mpg, data = .)) 
</code></pre>

<pre><code>## $`4`
## 
## Call:
## lm(formula = hp ~ mpg, data = .)
## 
## Coefficients:
## (Intercept)          mpg  
##      147.43        -2.43  
## 
## 
## $`6`
## 
## Call:
## lm(formula = hp ~ mpg, data = .)
## 
## Coefficients:
## (Intercept)          mpg  
##     164.156       -2.121  
## 
## 
## $`8`
## 
## Call:
## lm(formula = hp ~ mpg, data = .)
## 
## Coefficients:
## (Intercept)          mpg  
##     294.497       -5.648
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-18" style="background:;">
  <hgroup>
    <h2>Basic usage</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">map(LIST, FUN, ...)
</code></pre>

<ul>
<li>LIST = list to loop through</li>
<li>FUN = Function to loop through the list</li>
<li class='..'>Other arguments passed to the function</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-19" style="background:;">
  <hgroup>
    <h2>Different ways to specify functions</h2>
  </hgroup>
  <article data-timings="">
    <p>The below are equivalent</p>

<pre><code class="r">map(cyls, function(x) lm(hp ~ mpg, data = x))
map(cyls, ~lm(hp ~ mpg, data = .)) 
</code></pre>

<p>If we want to extract something from each element of the list, and the that something is named, we can also just supply that name as a string. </p>

<pre><code class="r">models &lt;- map(cyls, ~lm(hp ~ mpg, data = .)) 
map(models, &quot;coefficients&quot;)
</code></pre>

<pre><code>## $`4`
## (Intercept)         mpg 
##  147.431465   -2.430092 
## 
## $`6`
## (Intercept)         mpg 
##  164.156412   -2.120802 
## 
## $`8`
## (Intercept)         mpg 
##  294.497384   -5.647887
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-20" style="background:;">
  <hgroup>
    <h2>Different versions of map</h2>
  </hgroup>
  <article data-timings="">
    
<div style='float:left;width:48%;'>
  <p>If we call a single function, just list it.</p>

<pre><code class="r">lst &lt;- list(first = 1:3, 
            second = 80:100, 
            third = -2:4)

map(lst, mean)
</code></pre>

<pre><code>## $first
## [1] 2
## 
## $second
## [1] 90
## 
## $third
## [1] 1
</code></pre>

<p><code>map</code> will alway return a list. Other variants will return other output.</p>

</div>
<div style='float:right;width:48%;'>
  <pre><code class="r">map_df(lst, mean)
</code></pre>

<pre><code>## # A tibble: 1 × 3
##   first second third
##   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1     2     90     1
</code></pre>

<pre><code class="r">map_dbl(lst, mean)
</code></pre>

<pre><code>##  first second  third 
##      2     90      1
</code></pre>

<pre><code class="r">map_chr(lst, mean)
</code></pre>

<pre><code>##       first      second       third 
##  &quot;2.000000&quot; &quot;90.000000&quot;  &quot;1.000000&quot;
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-21" style="background:;">
  <hgroup>
    <h2>Putting them together</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(tidyverse)
map(cyls, ~lm(hp ~ mpg, data = .)) %&gt;% 
    map_df(coef) %&gt;% 
    mutate(param = c(&quot;intercept&quot;, &quot;slope&quot;)) %&gt;% 
    gather(cyl, val, -4) %&gt;% 
    spread(param, val)
</code></pre>

<pre><code>## # A tibble: 3 × 3
##     cyl intercept     slope
## * &lt;chr&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1     4  147.4315 -2.430092
## 2     6  164.1564 -2.120802
## 3     8  294.4974 -5.647887
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-22" style="background:;">
  <hgroup>
    <h2>Alternatively: <em>broom</em></h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">library(broom)
map(cyls, ~lm(hp ~ mpg, data = .)) %&gt;% 
    map_df(tidy)
</code></pre>

<pre><code>##          term   estimate  std.error  statistic     p.value
## 1 (Intercept) 147.431465  35.606406  4.1405882 0.002519431
## 2         mpg  -2.430092   1.318359 -1.8432709 0.098398581
## 3 (Intercept) 164.156412 146.508014  1.1204603 0.313430721
## 4         mpg  -2.120802   7.403631 -0.2864543 0.786020206
## 5 (Intercept) 294.497384  84.337195  3.4919040 0.004447715
## 6         mpg  -5.647887   5.512168 -1.0246218 0.325753780
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-23" style="background:;">
  <hgroup>
    <h2>More complex versions of <code>map</code></h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><code>map2</code> iterates over two lists (or any type of vector) in parallel</li>
<li><code>pmap</code> </li>
</ul>

<h1>Calculate differences in means</h1>

<p>(spacing added just for clarity)</p>

<div style='float:left;width:48%;'>
  <pre><code class="r">set.seed(222)
map2(list(rnorm(100), 
          rnorm(100),
          rnorm(100)),

     list(rnorm(100, 0.5), 
          rnorm(100, 1), 
          rnorm(100, 0.2)), 

    ~mean(.x) - mean(.y))
</code></pre>

</div>
<div style='float:right;width:48%;'>
  <pre><code>## [[1]]
## [1] -0.5997455
## 
## [[2]]
## [1] -1.083101
## 
## [[3]]
## [1] -0.2517111
</code></pre>

</div>
  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-24" style="background:;">
  <hgroup>
    <h2>Calculate effect sizes</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">set.seed(222)
map2_dbl(list(rnorm(100), 
              rnorm(100),
              rnorm(100)),

         list(rnorm(100, 0.5), 
              rnorm(100, 1), 
              rnorm(100, 0.2)),

    ~ (mean(.x) - mean(.y)) / sqrt(
        ((length(.x) - 1) * sd(.x) +  (length(.y) - 1) * sd(.y)) /
                     ((length(.x) + length(.y)) - 2)))
</code></pre>

<pre><code>## [1] -0.6061655 -1.0823470 -0.2482222
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-25" style="background:;">
  <hgroup>
    <h2><code>pmap</code></h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li>We won&#39;t focus on <code>pmap</code> today, but it&#39;s worth noting that the syntax is slightly different. You supply one (possibly nested) list with all the arguments to the function, and then supply the function.</li>
</ul>

<p>For example, setup a simulation with different sample sizes, means, and standard deviations. (In this particular example we could )</p>

<pre><code class="r">n &lt;- list(50, 100, 250, 500)
mu &lt;- list(10, 15, 10, 15)
stdev &lt;- list(1, 1, 2, 2)

sim_data &lt;- pmap(list(n, mu, stdev), rnorm)
str(sim_data)
</code></pre>

<pre><code>## List of 4
##  $ : num [1:50] 10.06 10.2 10.39 9.67 10.75 ...
##  $ : num [1:100] 15.1 16.5 17.2 14.4 15.2 ...
##  $ : num [1:250] 8.04 7.37 8.17 10.49 11.96 ...
##  $ : num [1:500] 15.4 15.7 15 18.4 17.8 ...
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-26" style="background:;">
  <hgroup>
    <h2>Use <code>map</code> to check simulation</h2>
  </hgroup>
  <article data-timings="">
    <ul>
<li><em>sim_data</em> is a list, so we can loop through it</li>
<li>We saw on the previous slide that the sample sizes were correct. What about the means and standard deviations?</li>
</ul>

<pre><code class="r">map_dbl(sim_data, mean)
</code></pre>

<pre><code>## [1] 10.045945 15.062124  9.768937 14.980899
</code></pre>

<pre><code class="r">map_dbl(sim_data, sd)
</code></pre>

<pre><code>## [1] 0.7623378 0.9640901 2.0434633 2.0012167
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-27" style="background:;">
  <hgroup>
    <h2>Nesting data frames</h2>
  </hgroup>
  <article data-timings="">
    <p>Rather than splitting data frames (as we did before), it can often be helpful to <code>nest()</code> them instead. The reason you would want to nest a data frame is for similar reasons to wanting to split it.</p>

<p>For example,</p>

<pre><code class="r">nested &lt;- mtcars %&gt;% 
    group_by(cyl) %&gt;% 
    nest()
nested
</code></pre>

<pre><code>## # A tibble: 3 × 2
##     cyl               data
##   &lt;dbl&gt;             &lt;list&gt;
## 1     6  &lt;tibble [7 × 10]&gt;
## 2     4 &lt;tibble [11 × 10]&gt;
## 3     8 &lt;tibble [14 × 10]&gt;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-28" style="background:;">
  <hgroup>
    <h2>List columns</h2>
  </hgroup>
  <article data-timings="">
    <p>In the previous example:</p>

<ul>
<li>Data are split by cylinder, just as before</li>
<li>The list of data are then stored into a list column in a data frame</li>
<li>Each &quot;cell&quot; in the list column contains all the data for that corresponding 
row in the data frame (cylinder).</li>
<li>In some ways this is a bit odd, but it can help us stay organized.</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-29" style="background:;">
  <article data-timings="">
    <pre><code class="r">nested$data
</code></pre>

<pre><code>## [[1]]
## # A tibble: 7 × 10
##     mpg  disp    hp  drat    wt  qsec    vs    am  gear  carb
##   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1  21.0 160.0   110  3.90 2.620 16.46     0     1     4     4
## 2  21.0 160.0   110  3.90 2.875 17.02     0     1     4     4
## 3  21.4 258.0   110  3.08 3.215 19.44     1     0     3     1
## 4  18.1 225.0   105  2.76 3.460 20.22     1     0     3     1
## 5  19.2 167.6   123  3.92 3.440 18.30     1     0     4     4
## 6  17.8 167.6   123  3.92 3.440 18.90     1     0     4     4
## 7  19.7 145.0   175  3.62 2.770 15.50     0     1     5     6
## 
## [[2]]
## # A tibble: 11 × 10
##      mpg  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   22.8 108.0    93  3.85 2.320 18.61     1     1     4     1
## 2   24.4 146.7    62  3.69 3.190 20.00     1     0     4     2
## 3   22.8 140.8    95  3.92 3.150 22.90     1     0     4     2
## 4   32.4  78.7    66  4.08 2.200 19.47     1     1     4     1
## 5   30.4  75.7    52  4.93 1.615 18.52     1     1     4     2
## 6   33.9  71.1    65  4.22 1.835 19.90     1     1     4     1
## 7   21.5 120.1    97  3.70 2.465 20.01     1     0     3     1
## 8   27.3  79.0    66  4.08 1.935 18.90     1     1     4     1
## 9   26.0 120.3    91  4.43 2.140 16.70     0     1     5     2
## 10  30.4  95.1   113  3.77 1.513 16.90     1     1     5     2
## 11  21.4 121.0   109  4.11 2.780 18.60     1     1     4     2
## 
## [[3]]
## # A tibble: 14 × 10
##      mpg  disp    hp  drat    wt  qsec    vs    am  gear  carb
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1   18.7 360.0   175  3.15 3.440 17.02     0     0     3     2
## 2   14.3 360.0   245  3.21 3.570 15.84     0     0     3     4
## 3   16.4 275.8   180  3.07 4.070 17.40     0     0     3     3
## 4   17.3 275.8   180  3.07 3.730 17.60     0     0     3     3
## 5   15.2 275.8   180  3.07 3.780 18.00     0     0     3     3
## 6   10.4 472.0   205  2.93 5.250 17.98     0     0     3     4
## 7   10.4 460.0   215  3.00 5.424 17.82     0     0     3     4
## 8   14.7 440.0   230  3.23 5.345 17.42     0     0     3     4
## 9   15.5 318.0   150  2.76 3.520 16.87     0     0     3     2
## 10  15.2 304.0   150  3.15 3.435 17.30     0     0     3     2
## 11  13.3 350.0   245  3.73 3.840 15.41     0     0     3     4
## 12  19.2 400.0   175  3.08 3.845 17.05     0     0     3     2
## 13  15.8 351.0   264  4.22 3.170 14.50     0     1     5     4
## 14  15.0 301.0   335  3.54 3.570 14.60     0     1     5     8
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-30" style="background:;">
  <hgroup>
    <h2>Fit multiple models</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">nested &lt;- nested %&gt;% 
    mutate(m1_mpg = map(data, ~lm(hp ~ mpg, data = .)),
           m2_mpg_disp = map(data, ~lm(hp ~ mpg + disp, data = .)))
nested
</code></pre>

<pre><code>## # A tibble: 3 × 4
##     cyl               data   m1_mpg m2_mpg_disp
##   &lt;dbl&gt;             &lt;list&gt;   &lt;list&gt;      &lt;list&gt;
## 1     6  &lt;tibble [7 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt;
## 2     4 &lt;tibble [11 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt;
## 3     8 &lt;tibble [14 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt;
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-31" style="background:;">
  <hgroup>
    <h2>See models for <em>mpg</em> and <em>disp</em></h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">nested$m2_mpg_disp
</code></pre>

<pre><code>## [[1]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Coefficients:
## (Intercept)          mpg         disp  
##    201.1055      -1.2504      -0.2953  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Coefficients:
## (Intercept)          mpg         disp  
##   140.68630     -2.29124      0.02894  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Coefficients:
## (Intercept)          mpg         disp  
##   311.35825     -6.06153     -0.03006
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-32" style="background:;">
  <hgroup>
    <h2>Summary of models for <em>mpg</em> and <em>disp</em></h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">map(nested$m2_mpg_disp, summary)
</code></pre>

<pre><code>## [[1]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##       1       2       3       4       5       6       7 
## -17.599 -17.599  11.841  -7.030  -4.605  -6.356  41.346 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 201.1055   144.6027   1.391    0.237
## mpg          -1.2504     7.1714  -0.174    0.870
## disp         -0.2953     0.2508  -1.177    0.304
## 
## Residual standard error: 25.4 on 4 degrees of freedom
## Multiple R-squared:  0.2694, Adjusted R-squared:  -0.09595 
## F-statistic: 0.7374 on 2 and 4 DF,  p-value: 0.5338
## 
## 
## [[2]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.026  -8.575   1.428   4.442  39.215 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 140.68630   99.64213   1.412    0.196
## mpg          -2.29124    2.35746  -0.972    0.360
## disp          0.02894    0.39565   0.073    0.943
## 
## Residual standard error: 19.94 on 8 degrees of freedom
## Multiple R-squared:  0.2745, Adjusted R-squared:  0.09318 
## F-statistic: 1.514 on 2 and 8 DF,  p-value: 0.277
## 
## 
## [[3]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -60.08 -27.76 -15.19  23.83 123.61 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 311.35825  167.65969   1.857   0.0903 .
## mpg          -6.06153    6.73483  -0.900   0.3874  
## disp         -0.03006    0.25441  -0.118   0.9081  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 53.11 on 11 degrees of freedom
## Multiple R-squared:  0.08161,    Adjusted R-squared:  -0.08536 
## F-statistic: 0.4888 on 2 and 11 DF,  p-value: 0.6261
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-33" style="background:;">
  <hgroup>
    <h2>For the <code>$</code> averse</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">nested %&gt;% 
    transmute(smry = map(m2_mpg_disp, summary)) %&gt;% 
    flatten()
</code></pre>

<pre><code>## [[1]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##       1       2       3       4       5       6       7 
## -17.599 -17.599  11.841  -7.030  -4.605  -6.356  41.346 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 201.1055   144.6027   1.391    0.237
## mpg          -1.2504     7.1714  -0.174    0.870
## disp         -0.2953     0.2508  -1.177    0.304
## 
## Residual standard error: 25.4 on 4 degrees of freedom
## Multiple R-squared:  0.2694, Adjusted R-squared:  -0.09595 
## F-statistic: 0.7374 on 2 and 4 DF,  p-value: 0.5338
## 
## 
## [[2]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.026  -8.575   1.428   4.442  39.215 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 140.68630   99.64213   1.412    0.196
## mpg          -2.29124    2.35746  -0.972    0.360
## disp          0.02894    0.39565   0.073    0.943
## 
## Residual standard error: 19.94 on 8 degrees of freedom
## Multiple R-squared:  0.2745, Adjusted R-squared:  0.09318 
## F-statistic: 1.514 on 2 and 8 DF,  p-value: 0.277
## 
## 
## [[3]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -60.08 -27.76 -15.19  23.83 123.61 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 311.35825  167.65969   1.857   0.0903 .
## mpg          -6.06153    6.73483  -0.900   0.3874  
## disp         -0.03006    0.25441  -0.118   0.9081  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 53.11 on 11 degrees of freedom
## Multiple R-squared:  0.08161,    Adjusted R-squared:  -0.08536 
## F-statistic: 0.4888 on 2 and 11 DF,  p-value: 0.6261
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-34" style="background:;">
  <hgroup>
    <h2>Another alternative</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">nested %&gt;% 
    select(m2_mpg_disp) %&gt;% 
    map(map, summary)
</code></pre>

<pre><code>## $m2_mpg_disp
## $m2_mpg_disp[[1]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##       1       2       3       4       5       6       7 
## -17.599 -17.599  11.841  -7.030  -4.605  -6.356  41.346 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 201.1055   144.6027   1.391    0.237
## mpg          -1.2504     7.1714  -0.174    0.870
## disp         -0.2953     0.2508  -1.177    0.304
## 
## Residual standard error: 25.4 on 4 degrees of freedom
## Multiple R-squared:  0.2694, Adjusted R-squared:  -0.09595 
## F-statistic: 0.7374 on 2 and 4 DF,  p-value: 0.5338
## 
## 
## $m2_mpg_disp[[2]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -27.026  -8.575   1.428   4.442  39.215 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) 140.68630   99.64213   1.412    0.196
## mpg          -2.29124    2.35746  -0.972    0.360
## disp          0.02894    0.39565   0.073    0.943
## 
## Residual standard error: 19.94 on 8 degrees of freedom
## Multiple R-squared:  0.2745, Adjusted R-squared:  0.09318 
## F-statistic: 1.514 on 2 and 8 DF,  p-value: 0.277
## 
## 
## $m2_mpg_disp[[3]]
## 
## Call:
## lm(formula = hp ~ mpg + disp, data = .)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -60.08 -27.76 -15.19  23.83 123.61 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)  
## (Intercept) 311.35825  167.65969   1.857   0.0903 .
## mpg          -6.06153    6.73483  -0.900   0.3874  
## disp         -0.03006    0.25441  -0.118   0.9081  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 53.11 on 11 degrees of freedom
## Multiple R-squared:  0.08161,    Adjusted R-squared:  -0.08536 
## F-statistic: 0.4888 on 2 and 11 DF,  p-value: 0.6261
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-35" style="background:;">
  <hgroup>
    <h2>Compare Models</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">nested &lt;- nested %&gt;% 
    mutate(m12_comp = map2(m1_mpg, m2_mpg_disp, anova), 
           p = map(m12_comp, &quot;Pr(&gt;F)&quot;),
           p = map_dbl(p, `[`, 2))
nested
</code></pre>

<pre><code>## # A tibble: 3 × 6
##     cyl               data   m1_mpg m2_mpg_disp        m12_comp         p
##   &lt;dbl&gt;             &lt;list&gt;   &lt;list&gt;      &lt;list&gt;          &lt;list&gt;     &lt;dbl&gt;
## 1     6  &lt;tibble [7 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt; &lt;anova [2 × 6]&gt; 0.3043020
## 2     4 &lt;tibble [11 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt; &lt;anova [2 × 6]&gt; 0.9434844
## 3     8 &lt;tibble [14 × 10]&gt; &lt;S3: lm&gt;    &lt;S3: lm&gt; &lt;anova [2 × 6]&gt; 0.9080672
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-36" style="background:;">
  <hgroup>
    <h2>Extract all coefficients</h2>
  </hgroup>
  <article data-timings="">
    <pre><code class="r">coefs &lt;- nested %&gt;% 
    select(3:4) %&gt;% 
    map(map_df, tidy) 
coefs
</code></pre>

<pre><code>## $m1_mpg
##          term   estimate  std.error  statistic     p.value
## 1 (Intercept) 164.156412 146.508014  1.1204603 0.313430721
## 2         mpg  -2.120802   7.403631 -0.2864543 0.786020206
## 3 (Intercept) 147.431465  35.606406  4.1405882 0.002519431
## 4         mpg  -2.430092   1.318359 -1.8432709 0.098398581
## 5 (Intercept) 294.497384  84.337195  3.4919040 0.004447715
## 6         mpg  -5.647887   5.512168 -1.0246218 0.325753780
## 
## $m2_mpg_disp
##          term     estimate   std.error   statistic   p.value
## 1 (Intercept) 201.10545950 144.6026821  1.39074502 0.2366760
## 2         mpg  -1.25040042   7.1713987 -0.17435935 0.8700522
## 3        disp  -0.29530305   0.2508059 -1.17741686 0.3043020
## 4 (Intercept) 140.68630194  99.6421350  1.41191577 0.1956675
## 5         mpg  -2.29123552   2.3574552 -0.97191054 0.3595602
## 6        disp   0.02894082   0.3956489  0.07314773 0.9434844
## 7 (Intercept) 311.35824930 167.6596917  1.85708471 0.0902559
## 8         mpg  -6.06152869   6.7348316 -0.90002676 0.3873854
## 9        disp  -0.03006197   0.2544069 -0.11816490 0.9080672
</code></pre>

  </article>
  <!-- Presenter Notes -->
</slide>

<slide class="" id="slide-37" style="background:;">
  <hgroup>
    <h2>Next steps</h2>
  </hgroup>
  <article data-timings="">
    <p>From here we could go on to plotting, etc., instead, let&#39;s look at a full, applied example that uses some of these topics.</p>

<h1>Context</h1>

<ul>
<li>Evaluating intervention response through &quot;checkpoints&quot;</li>
<li>Only concerning if students do not receive full credit at each checkpoint</li>
<li>Evaluate patterns of checkpoint response to see if we can identify different types of non-responders</li>
</ul>

<h1>Analysis</h1>

<ul>
<li>Examine means at pre- and post-test on various measures of mathematics for student groups (according to their patterns of response)</li>
<li>Examine residual gains by groups</li>
<li>Ask Lina if you have more questions, she&#39;s the guru here.</li>
</ul>

  </article>
  <!-- Presenter Notes -->
</slide>

    <slide class="backdrop"></slide>
  </slides>
  <div class="pagination pagination-small" id='io2012-ptoc' style="display:none;">
    <ul>
      <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=1 title='NA'>
         1
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=2 title='lists'>
         2
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=3 title='Lists versus other data structures'>
         3
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=4 title='Contrasting lists and atomic vectors'>
         4
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=5 title='Quick aside'>
         5
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=6 title='Lists'>
         6
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=7 title='Lists returned by functions'>
         7
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=8 title='NA'>
         8
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=9 title='Extractors'>
         9
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=10 title='Other functions will transform data into lists'>
         10
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=11 title='More on lists'>
         11
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=12 title='Lists and data frames'>
         12
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=13 title='Alternative'>
         13
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=14 title='Brief introduction to <em>purrr</em>'>
         14
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=15 title='<em>purrr</em>'>
         15
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=16 title='Data'>
         16
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=17 title='<code>map</code> basic usage'>
         17
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=18 title='Basic usage'>
         18
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=19 title='Different ways to specify functions'>
         19
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=20 title='Different versions of map'>
         20
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=21 title='Putting them together'>
         21
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=22 title='Alternatively: <em>broom</em>'>
         22
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=23 title='More complex versions of <code>map</code>'>
         23
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=24 title='Calculate effect sizes'>
         24
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=25 title='<code>pmap</code>'>
         25
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=26 title='Use <code>map</code> to check simulation'>
         26
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=27 title='Nesting data frames'>
         27
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=28 title='List columns'>
         28
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=29 title='NA'>
         29
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=30 title='Fit multiple models'>
         30
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=31 title='See models for <em>mpg</em> and <em>disp</em>'>
         31
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=32 title='Summary of models for <em>mpg</em> and <em>disp</em>'>
         32
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=33 title='For the <code>$</code> averse'>
         33
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=34 title='Another alternative'>
         34
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=35 title='Compare Models'>
         35
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=36 title='Extract all coefficients'>
         36
      </a>
    </li>
    <li>
      <a href="#" target="_self" rel='tooltip' 
        data-slide=37 title='Next steps'>
         37
      </a>
    </li>
  </ul>
  </div>  <!--[if IE]>
    <script 
      src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js">  
    </script>
    <script>CFInstall.check({mode: 'overlay'});</script>
  <![endif]-->
</body>
  <!-- Load Javascripts for Widgets -->
  
  <!-- MathJax: Fall back to local if CDN offline but local image fonts are not supported (saves >100MB) -->
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true
      }
    });
  </script>
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <!-- <script src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  </script> -->
  <script>window.MathJax || document.write('<script type="text/x-mathjax-config">MathJax.Hub.Config({"HTML-CSS":{imageFont:null}});<\/script><script src="libraries/widgets/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"><\/script>')
</script>
<!-- LOAD HIGHLIGHTER JS FILES -->
  <script src="libraries/highlighters/highlight.js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <!-- DONE LOADING HIGHLIGHTER JS FILES -->
   
  </html>